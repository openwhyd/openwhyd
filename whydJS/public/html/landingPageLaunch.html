<!DOCTYPE html>
<html>
  <head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>{{title}}</title>
	<link href="/favicon.ico" rel="shortcut icon" type="image/x-icon" />
	<link href="/favicon.png" rel="icon" type="image/png" />
	<link href="{{pageThumb}}" rel="image_src" />
	<meta property="og:image" content="{{pageThumb}}" />
	<meta property="og:description" content="{{pageDesc}}" />
    <meta name="description" content="{{pageDesc}}" />
    <link rel="stylesheet" media="screen" href="/css/landingPageLaunch.css" />
	<script src="/js/jquery-1.8.2.min.js" type="text/javascript" charset="utf-8"></script>
	<script src="/js/jquery.placeholder.min.js" type="text/javascript" charset="utf-8"></script>
	<script src="/js/jquery.simplemodal.1.4.4.min.js" type="text/javascript" charset="utf-8"></script>
	<script src="/js/ui.js" type="text/javascript" charset="utf-8"></script>
	{{{head}}}
  </head>
    <body>
    	<div id="fb-root"></div>
    
    <div class="wraphead">
    <div id="header">
    	<a href="/">
    		<img src="/images/landing/logo.png" alt="" width="110" height="45" />
    	</a>
    	<a href="/login" class="signin">Sign in</a>
    </div>
    
    <div class="contenthead">
	    <h1>the place for music lovers</h1>
	    <div class="video">
	    <a href="javascript:openVideo();" id="play">Play</a>
	    </div>
	    
	    <div class="calltoaction">
		    <a href="#invite" class="ask">Ask for an invite</a>
		    <!--<a href="/signup" class="ask">Sign up</a>-->
		    <a href="#learn" class="learn">Learn More</a>
	    </div>
    </div>
    
    </div>
    
    <div class="keep" id="learn">
    	<div class="wrapbody">
    		<div class="illustration"><img src="/images/landing/illu1.png" alt="" name="" width="280" height="208" /></div>
   			 <h2>Keep</h2>
   			 <p>There are billions of tracks available in direct access on the internet. It's the biggest source of music in the world. OpenWhyd let’s you keep every track in one place.</p>
    	<div class="clear"></div>
   		</div>
    </div>
    
    
    
    <div class="play">
	    <div class="wrapbody">
		    <div class="illustration"><img src="/images/landing/illu2.png" alt="" name="" width="280" height="208" /></div>
			    <h2>Play</h2>
			    <p>Organize your tracks into playlists, and play them all without any interruption in our player. Listen to your playlists, your stream, or visit other music lovers' pages to hear their music. Just push play and it works.</p>
		    </div>
    </div>
    
    <div class="share">
	    <div class="wrapbody">
		    <div class="illustration"><img src="/images/landing/illu3.png" alt="" name="" width="280" height="208" /></div>
			    <h2>Share</h2>
			    <p>Music is better shared. OpenWhyd is a social network designed for music lovers, where every song added means a song shared. 
			    Subscribe to people, and customize your incoming stream to your taste for effortless music discovery.</p>
		    </div>
    </div>
    
    <div class="footer">
	    <div class="wrapbody">
	     
	    	<div class="cool-people">
	    		<h2>Music lovers in residence</h2>
	    		<div id="sliderWindow">
				    <ul>
					    {{#featuredUsers}}
					    <li>
						    <a href="/u/{{id}}">
							    <img src="/images/landing/avatar/{{id}}.jpg" width="112" height="112" />
							    <h3>{{name}}</h3>					    
						    </a>
					    </li>
					    {{/featuredUsers}}
					    <div class="clear"></div>
				    </ul>
				</div>
			    <div id="slider">
			    	<span class="selected">●</span>
			    	<span>●</span>
			    	<span>●</span>
			    	<span>●</span>
			    </div>
	    </div>
    
	  	<div id="invite">
	  		<h3>Ask for an invite</h3>
		  	<form id="askInvite" method="get" action="/login">
		  		<div id="fields">
				  	<input type="text" id="fldEmail" name="mail" placeholder="Enter your email">
				  	<input type="submit" id="btnSubmit" value="Go">
			  	</div>
			  	<p class="validation">{{#message}}{{text}}{{/message}}</p>
				<div id="share" style="display:none;">
					<a href="http://twitter.com/share" class="twitter-share-button" data-url="http://openwhyd.org" data-text="I just signed up for @open_whyd, ask for an invite!" data-count="none" data-via="open_whyd">Tweet</a><script type="text/javascript" src="http://platform.twitter.com/widgets.js"></script>
					<iframe src="http://www.facebook.com/plugins/like.php?href=http%3A%2F%2Fopenwhyd.org&amp;layout=button_count&amp;show_faces=false&amp;width=100&amp;action=like&amp;font&amp;colorscheme=light&amp;height=21" scrolling="no" frameborder="0" style="border:none; overflow:hidden; width:100px; height:21px; position:relative; top:1px; left:10px;" allowTransparency="true"></iframe>
				</div>
		  	</form> 
	  	</div>
	    <!--
	  	<div id="invite">
	    <div class="calltoaction">
		    <a href="/signup" class="ask">Sign up</a>
		    <a href="/login" class="learn">Log in</a>
	    </div>
	    </div>
	  	-->
	  	
	  	<div class="social-link">
	  		<ul>
	  			<li><a target="_blank" href="http://www.facebook.com/openwhyd">Facebook</a></li>
	  			<li><a target="_blank" href="http://twitter.com/open_whyd">Twitter</a></li>
	  			<li class="last-social"><a target="_blank" href="http://blog.openwhyd.org/">Blog</a></li>
	  		</ul>
	  		<div class="clear"></div>
	  		<div class="separation"></div>
	  		<p>OpenWhyd © 2016 Lovingly hand-crafted in Paris </p>
	  	</div>
  	</div>
  	</div>
    
	<script>
	//<![CDATA[
		var $form = $("form#askInvite");
		var $message = $form.find(".validation");
		var $email = $("#fldEmail").placeholder();
		var defVal = $email.attr("placeholder");
		var emailCheck = /^[\w\.\+\-]+@[a-z0-9\.\-]+\.[a-z]{2,4}$/i;

		var backtonormal = function() {
			$form.removeClass("error");
			$email.unbind();
		};

		var handleResponse = function(res) {
			var res = res || {};
			backtonormal();
			if (res.error) {
				$message.text(res.error);
				$form.addClass("error");
				$email.click(backtonormal).keydown(backtonormal);
			}
			else if (res.result)
				$("#fields").animate({height:"0px"}, function() {
					$form.addClass("ok");
					$message.html(res.result);
					if (res.redirect)
						window.location.href = res.redirect;
					else
						$("#share").fadeIn();
				});
		};
		
		$("#askInvite").submit( function(event) {
			event.preventDefault();
			if ($email.val() == defVal || !emailCheck.test($email.val()))
				handleResponse({error: "Please enter a valid email address"});
			else
				$.ajax({
					type: "GET",
					url: "/login",
					data: {mail: $email.val()},
					success: handleResponse
				});
			return false;
		});
		
		// can be triggered by controller if email is linked to a known openwhyd user
		function login() { 
			window.location.href = "/login?email="+$email.val();
		}

		function openVideo() {
			openHtmlDialog('<iframe src="http://player.vimeo.com/video/67048023?badge=0&amp;autoplay=1" width="640" height="400" frameborder="0" webkitAllowFullScreen mozallowfullscreen allowFullScreen></iframe>');
			/* 53666841 */
		}

		// nice looking anchor scrolling

		var smoothAnchor = function(callback) {
			return function(e) {
				$("html,body").animate({
					scrollTop: $($(this).attr("href")).offset().top
				}, 800, callback);
				e.preventDefault();
				return false;
			};
		};

		$("a[href=#learn]").click(smoothAnchor());
		$("a[href=#invite]").click(smoothAnchor(function() {
			$email.focus();
		}));

		// slider

		var $sliderUl = $("#sliderWindow ul");
		var $pages = $("#slider span").click(function() {
			var p = $pages.removeClass("selected").index(this);
			$(this).addClass("selected");
			console.log("left", (-p * 940) + "px");
			$sliderUl.animate({ "left": (-p * 940) + "px" }, 800);
		});

		// adjusts first div according to window's size

		var h = $(window).height() - 40;
		$(".wraphead").height(h);
		$(".contenthead").css({ "margin-top": Math.max(60, (h/2) - 60 - (400/2)) });
	//]]>
	</script>

    </body>
</html>