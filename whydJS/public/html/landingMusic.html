<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" /> 
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="cache-control" content="no-cache"/>
  <meta http-equiv="Pragma" content="no-cache" />
  <meta http-equiv="expires" content="0" />
  <title>{{title}}</title>
  <link rel="image_src" href="{{urlPrefix}}/images/logo-black-square-smaller.png"/>
  <meta property="og:image" content="{{urlPrefix}}/images/logo-black-square-smaller.png" />
  <meta property="og:description" content="All your streaming music in one place" />
  <link href="/images/favicon.ico" rel="shortcut icon" type="image/x-icon" />
  <link href="/images/favicon.png" rel="icon" type="image/png" />
  <script src="/js/jquery-1.8.2.min.js" type="text/javascript" charset="utf-8"></script>
  <script src="/js/jquery.placeholder.min.js" type="text/javascript" charset="utf-8"></script>
  <script src="/js/jquery.simplemodal.1.4.4.min.js" type="text/javascript" charset="utf-8"></script>
  <script src="/js/jquery.iframe-post-form.min.js" type="text/javascript" charset="utf-8"></script>
  <script src="/js/ui.js" type="text/javascript" charset="utf-8"></script>
  <style type="text/css">
	/*<![CDATA[*/

	body {
		background: #FFF;
		font-family: "Helvetica Neue", Helvetica, Arial, Sans-serif;
		font-size: 13px;
		margin: 0;
		padding: 0;
	}

	a {
		color: #3177AF;
		text-decoration: none;
	}

	/* NAVIGATION */
	#header {
		background: url(/images/landing-back.png) repeat;
		height:400px;
	}

	.container {
		width: 960px;
		margin: 0 auto;
		padding: 10px;
	}

	/* SIGN IN */
	#navigation {
		padding-bottom: 56px;
		
	}

	#navigation p {
		float: right;
	}

	#navigation p a {
		font-size: 14px;
		font-weight: bold;
		text-shadow: 0 1px 0 rgba(255,255,255,1);
	}

	/* LOGO + BASELINE */
	.content h1 {
		padding: 0 0 20px 0;	
		margin: 0;
	}

	.content h2 {
		padding: 0 0 30px 0;
		margin: 0;
	}

	.content h1 img {
		border: none;
	}

	.content h2 img {
		border: none;
	}


	/* INPUT + SUBMIT */

	#askInvite {
		overflow: hidden;
	}

	#fldEmail {
		border: none;
		box-shadow: inset 0 1px 2px rgba(0,0,0,0.3),;
		-webkit-box-shadow: inset 0 1px 2px rgba(0,0,0,0.3);
		-moz-box-shadow: inset 0 1px 2px rgba(0,0,0,0.3);
		width: 430px;
		padding: 18px 10px;
		font-size: 14px;
		color: #575757;
		border-radius: 2px;
		-webkit-border-radius: 2px;
		-moz-border-radius: 2;
	}

	#fldEmail.error {
		background-color: #ffa9a9;
	}

	#btnSubmit {
		background: #3177AF;
		padding: 18px 30px;
		font-weight: bold;
		font-size: 14px;
		color: white;
		border: none;
		cursor: pointer;
		border-radius: 3px;
		-webkit-border-radius: 3px;
		-moz-border-radius: 3px;
		cursor: pointer;
		box-shadow: 0 1px 0 rgba(255,255,255,1);
		-webkit-box-shadow: 0 1px 0 rgba(255,255,255,1);
		-moz-box-shadow: 0 1px 0 rgba(255,255,255,1);
		/*margin: 10px 0 0 0; */
	}

	#btnSubmit:hover {
		background: #b7d874;
	}

	#btnSubmit:active {
		background: #3177AF;
		border: none;
		box-shadow: inset 0 1px 4px rgba(0,0,0,0.4);
		-webkit-box-shadow: inset 0 1px 4px rgba(0,0,0,0.4);
		-moz-box-shadow: inset 0 1px 4px rgba(0,0,0,0.4);
	}

	#share > p {
		font-size: 16px;
		color: #666;
		text-shadow: 0 1px 0 rgba(255, 255, 255, 1);
	}

	/* FOOTER */
	#footer > div {
		float: left;
	}

	#footer > div {
		width: 300px;
	}

	#footer > div > h4 {
		color: #666666;
		font-weight: bold;
		font-size: 18px;
		margin: 0;
		padding: 0;
	}

	#footer > div > p {
		color: #8d8d8d;
		line-height: 20px;
	}

	#footer > .point1 {
		margin: 0 10px 0 0;
	}

	#footer > .point2 {
		margin: 0 10px 0 0;
	}

	#footer > .point2 {
	}

	#footer > .point1 > h4.keep {
		background:url(/images/landing-keep.png) no-repeat -3px 0;
		padding: 10px 0 0 44px;
	}

	#footer > .point2 > h4.play {
		background:url(/images/landing-play.png) no-repeat -3px 0;
		padding: 10px 0 0 44px;
	}

	#footer > .point3 > h4.share {
		background:url(/images/landing-share.png) no-repeat -2px 0;
		padding: 10px 0 0 44px;
	}
	/*]]>*/
  </style>
  <script src="/js/whydtr.js"></script>
</head>
<body>
	
	<div id="header">
		<div class="container">
			<div id="navigation">
				<p><a href="/login" id="loginLink">Sign in</a></p>
			</div>
			{{#message}}
			<div id="messageBox">
				<div>
					<span>{{text}}</span>
				</div>
			</div>
			{{/message}}
		</div>

		<div class="content container">
			<h1><img src="/images/landing-logo.png" alt="OpenWhyd" title="Whyd" width="199" height="81" /></h1>
				<h2><img src="/images/landing-subtitle.png" alt="All your streaming music in one place" title="All your streaming music in one place" width="456" height="23" /></h2>
			
			<form id="askInvite" method="get" action="/login">
				<input type="text" id="fldEmail" name="mail" placeholder="Enter your email to ask for an invite" />
				<input type="submit" id="btnSubmit" value="Go" />
			</form>

			<div id="share" style="display:none;">
				<p>Awesome, we just sent you an email! Check your spam folder if you don't receive it.</p>
				<a href="http://twitter.com/share" class="twitter-share-button" data-url="http://openwhyd.org" data-text="I just signed up for @open_whyd, ask for an invite!" data-count="none" data-via="open_whyd">Tweet</a><script type="text/javascript" src="http://platform.twitter.com/widgets.js"></script>
				<iframe src="http://www.facebook.com/plugins/like.php?href=http%3A%2F%2Fopenwhyd.org&amp;layout=button_count&amp;show_faces=false&amp;width=100&amp;action=like&amp;font&amp;colorscheme=light&amp;height=21" scrolling="no" frameborder="0" style="border:none; overflow:hidden; width:100px; height:21px; position:relative; top:1px; left:10px;" allowTransparency="true"></iframe>
			</div>
		</div>
	</div>
	
	<div id="footer" class="container">
		<div class="point1">
			<h4 class="keep">Keep</h4>
			<p>Add your tracks from sites like YouTube, Soundcloud, Hypemachine, and more to your library, say goodbye to lost links and songs.</p>
		</div>
		<div class="point2">
			<h4 class="play">Play</h4>
			<p>All your tracks together in our player, no more clicking around every three minutes.</p>
		</div>
		
		<div class="point3">
			<h4 class="share">Share</h4>
			<p>With the community, or social media it up!</p>
		</div>
	</div>

	<script>
	//<![CDATA[
		// if ("{{loggedUid}}" != "")
		//	window.location.href = "{{whydUrl}}"; 
		
		var email = $("#fldEmail").placeholder();
		var defVal = email.attr("placeholder");
		var emailCheck = /^[a-z0-9\u007F-\uffff!#$%&'*+\/=?^_`{|}~-]+(?:\.[a-z0-9\u007F-\uffff!#$%&'*+\/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z]{2,}$/i;

		var backtonormal = function() {
			email.unbind().removeClass("error");
		};
		
		$("#askInvite").submit( function(event) {
			event.preventDefault();
			if (email.val() == defVal || !emailCheck.test(email.val()))
				email
					.addClass("error")
					.click(backtonormal)
					.keydown(backtonormal);
			else
				$.ajax({
					type: "GET",
					url: "/login",
					data: {mail: email.val()},
					success: function(res) {
						var res = res || {};
						$("#askInvite").animate({height:"0px"}, function() {
							$("#share").find("p").first().html(res.result);
							if (res.redirect)
								window.location.href = res.redirect;
							else
								$("#share").fadeIn();
						});
					}
				});
			return false;
		});
		
		// can be triggered by controller if email is linked to a known openwhyd user
		function login() { 
			window.location.href = "/login?email="+email.val();
		}
	//]]>
	</script>
</body>
</html>
